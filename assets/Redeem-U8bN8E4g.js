import{r as t,j as e,H as B,m as E,N as O,M as R,e as C,i as S,l as F,F as A}from"./index-Dlgmt35C.js";import{g as N,b as I,r as w,s as L,w as v,a as y}from"./neobux-Dxdtxsyl.js";import"./blur-lYBwKAOk.js";import{M as P}from"./MobButton-Da57uynu.js";/* empty css              */import{b as D}from"./footer-hp-placeholder-CztAhs1A.js";/* empty css              */import{B as T}from"./Button-nKtblC0U.js";import{d as _}from"./thripleDots-BwcXsPjm.js";import{l as H}from"./cast-footer-geometry-mN0rrURH.js";import"./react-spring_web.modern-DnuaONtd.js";import"./clipright-bxBpsLPv.js";import"./buttonSvg-BnbybrfL.js";const Y=({onLogin:i})=>{const[n,o]=t.useState(!1),[m,c]=t.useState("0.0"),[r,l]=t.useState(!1),[d,s]=t.useState(!1),[u,x]=t.useState(!1),p=window.innerWidth<=430;t.useEffect(()=>{b()},[]);const h=()=>{o(a=>!a)},g=()=>{C.post("/api/auth/signOut",{})},j=async()=>{try{s(!0);const a=await N(),M=(await S(a)).data.data,k=await L(M);await F(a,k),l(!0),b(),i(),s(!1)}catch(a){console.error("Login failed:",a),s(!1)}},b=async()=>{try{x(!0);const a=await N();if(a){const f=await I(a);c(f.data.balance),l(!0)}x(!1)}catch(a){console.error("Failed to fetch balance:",a),x(!1)}};return e.jsxs("div",{className:"redeem-header-wrapper",children:[e.jsx(B,{}),p?e.jsxs("div",{className:"mobile-title-box",children:[e.jsxs("div",{className:"balance-mob-text",children:[e.jsx("span",{children:"Your Balance:"}),e.jsxs("div",{className:"balance-count",children:[m," NEOBux"]}),e.jsx("button",{className:"reload-btn",onClick:b,disabled:u,children:e.jsx("img",{src:w,alt:"refresh-balance",className:`refresh-balance ${u?"spinning":""}`})})]}),e.jsxs("h2",{className:"staking-title",children:["redeem ",e.jsx("br",{}),"rewards"]}),e.jsx("div",{className:"balance-mob-box",children:e.jsx("button",{className:"button-balance",onClick:r?g:j,disabled:d,children:e.jsx("span",{children:r?"Disconnect wallet":"Connect your wallet"})})})]}):e.jsxs("div",{className:"title-box",children:[e.jsx("h2",{className:"redeem-title",children:"redeem rewards"}),e.jsxs("div",{className:"balance-box",children:[e.jsx("button",{className:"button-balance",onClick:r?g:j,disabled:d,children:e.jsx("span",{children:r?"Disconnect wallet":"Connect your wallet"})}),e.jsxs("div",{className:"balance-text",children:[e.jsx("span",{children:"Your Balance:"}),e.jsxs("div",{className:"balance-count",children:[m," NEOBux"]}),e.jsx("button",{className:"reload-btn",onClick:b,disabled:u,children:e.jsx("img",{src:w,alt:"refresh-balance",className:`refresh-balance ${u?"spinning":""}`})})]})]})]}),p?e.jsx("div",{className:"menu-mob-wrapper",children:e.jsx("img",{src:E,className:"sidebar-mob-btn",onClick:h,alt:"menuMob-hp"})}):e.jsx(O,{}),n&&e.jsx(R,{onClose:h,isOpen:n})]})},$="/MaximGordiyenko/neofilms-frontend/assets/coin-zAnQ9C4y.svg";async function G(){return await C.get("/api/reward/eligibility-passes",{withCredentials:!0})}const W=({authCount:i})=>{const n=window.innerWidth<=430,[o,m]=t.useState(null),[c,r]=t.useState([]);t.useEffect(()=>{l()},[i]);const l=async()=>{try{const s=(await G()).data;m(s.approve),r(s.passes),console.log("eligible passes:",s)}catch(s){console.error("Failed to fetch eligible passes:",s)}},d=async()=>{try{o&&(console.log("approve tx:",o),await v(await y(o)));for(let s of c)s.purchase_tx&&(console.log("purchase tx:",s.purchase_tx),await v(await y(s.purchase_tx)))}catch(s){console.error("Failed to claim promotion:",s)}await l()};return e.jsx("div",{className:"redeem-body-wrapper",children:e.jsxs("div",{className:"content-box-redeem",children:[e.jsxs("div",{className:"form-box-redeem",children:[e.jsx("h4",{children:"Turn Your NEOBux Into IRL Rewards"}),e.jsx("p",{children:"Use your NEOBux tokens to receive discounts and special promotions from the NMF network. Choose a promotion, select claim, head to the Coupon page to see your codes. Please note that claiming promotions can take up to 20 seconds."}),e.jsxs("div",{className:"form-btn-box",children:[e.jsx("img",{src:_,alt:"redeem-dots"}),e.jsx("div",{className:"hr"}),n?e.jsx(P,{btnText:"claim",onClick:d,disabled:!c.length}):e.jsx(T,{isGlitch:!0,text:"claim",onClick:d,disabled:!c.length})]})]}),e.jsx("img",{src:$,alt:"redeem-coin",className:"coin"}),e.jsx("img",{src:n?H:D,alt:"bottom-redeem",className:"bottom-redeem-line"})]})})},ne=()=>{const[i,n]=t.useState(0),o=()=>{n(i+1)};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{onLogin:o}),e.jsx(W,{authCount:i}),e.jsx(A,{})]})};export{ne as default};
