import{r as l,j as e,H as M,m as O,N as T,M as E,e as r,i as B,l as F,h as I,k as $,F as R}from"./index-Dlgmt35C.js";import{g as y,b as A,r as v,s as L,w as b,a as j}from"./neobux-Dxdtxsyl.js";import"./blur-lYBwKAOk.js";import{M as W}from"./MobButton-Da57uynu.js";import{B as C}from"./Button-nKtblC0U.js";import{b as D}from"./footer-hp-placeholder-CztAhs1A.js";import{l as P}from"./cast-footer-geometry-mN0rrURH.js";import{C as H}from"./Modal-CMyj1VhT.js";import"./clipright-bxBpsLPv.js";import"./buttonSvg-BnbybrfL.js";const U=({onLogin:s})=>{const[n,o]=l.useState(!1),h=window.innerWidth<=430,[x,d]=l.useState("0.0"),[u,g]=l.useState(!1),[w,m]=l.useState(!1),[a,t]=l.useState(!1);l.useEffect(()=>{p()},[]);const i=()=>{o(c=>!c)},k=()=>{r.post("/api/auth/signOut",{})},f=async()=>{try{m(!0);const c=await y(),S=(await B(c)).data.data,_=await L(S);await F(c,_),g(!0),await p(),s(),m(!1)}catch(c){console.error("Login failed:",c),m(!1)}},p=async()=>{try{t(!0);const c=await y();if(c){const N=await A(c);d(N.data.balance),g(!0)}t(!1)}catch(c){console.error("Failed to fetch balance:",c),t(!1)}};return e.jsxs("div",{className:"staking-header-wrapper",children:[e.jsx(M,{}),h?e.jsxs("div",{className:"mobile-title-box",children:[e.jsxs("div",{className:"balance-mob-text",children:[e.jsx("span",{children:"Your Balance:"}),e.jsxs("div",{className:"balance-count",children:[x," NEOBux"]}),e.jsx("button",{className:"reload-btn",onClick:p,disabled:a,children:e.jsx("img",{src:v,alt:"refresh-balance",className:`refresh-balance ${a?"spinning":""}`})})]}),e.jsxs("h2",{className:"staking-title",children:["neo ",e.jsx("br",{}),"staking"]}),e.jsx("div",{className:"balance-mob-box",children:e.jsx("button",{className:"button-balance",onClick:u?k:f,disabled:w,children:e.jsx("span",{children:u?"Disconnect wallet":"Wallet connect"})})})]}):e.jsxs("div",{className:"title-box",children:[e.jsx("h2",{className:"staking-title",children:"neo staking"}),e.jsxs("div",{className:"balance-box",children:[e.jsx("button",{className:"button-balance",onClick:u?k:f,disabled:w,children:e.jsx("span",{children:u?"Disconnect wallet":"Wallet connect"})}),e.jsxs("div",{className:"balance-text",children:[e.jsx("span",{children:"Your Balance:"}),e.jsxs("div",{className:"balance-count",children:[x," NEOBux"]}),e.jsx("button",{className:"reload-btn",onClick:p,disabled:a,children:e.jsx("img",{src:v,alt:"refresh-balance",className:`refresh-balance ${a?"spinning":""}`})})]})]})]}),h?e.jsx("div",{className:"menu-mob-wrapper",children:e.jsx("img",{src:O,className:"sidebar-mob-btn",onClick:i,alt:"menuMob-hp"})}):e.jsx(T,{}),n&&e.jsx(E,{onClose:i,isOpen:n})]})};async function G(){return await r.get("/api/staking/pools",{withCredentials:!0})}function Y(s){return`/api/staking/pool/${s}/image`}async function q(s){return await r.get(`/api/staking/pool/${s}/info`,{withCredentials:!0})}async function z(){return await r.get("/api/staking/list",{withCredentials:!0})}async function K(s){return await r.get(`/api/staking/tokens/${s}`,{withCredentials:!0})}async function Q(s){return await r.get(`/api/staking/approve-all/${s}`,{withCredentials:!0})}async function J(s,n){return await r.post(`/api/staking/stake/${s}`,{token_ids:n},{withCredentials:!0})}async function V(s,n){return await r.post(`/api/staking/unstake/${s}`,{token_ids:n},{withCredentials:!0})}async function X(s){return await r.get(`/api/staking/claim/${s}`,{withCredentials:!0})}async function Z(s){return(await r.get(`/api/staking/rewards/${s}`,{withCredentials:!0})).data.amount}const ee=({authCount:s})=>{const[n,o]=l.useState([]),[h,x]=l.useState([]),d=async()=>{const a=(await G()).data;for(let t=0;t<a.length;t++)a[t].total_staked=0,a[t].nft_to_stake=[],a[t].unclaimed="0",a[t].img=Y(a[t].id);o([...a]);for(let t=0;t<a.length;t++){const i={...a[t]};a[t]=i,i.total_staked=(await q(i.id)).data.totalStaked}o([...a]);try{if((await I()).data){for(let t=0;t<a.length;t++){const i={...a[t]};a[t]=i,i.nft_to_stake=(await K(i.id)).data;try{i.unclaimed=await Z(i.id)}catch(k){console.error(k)}}o([...a]),x((await z()).data)}}catch(t){console.error(t)}};l.useEffect(()=>{d()},[s]);const u=async a=>{if(a.nft_to_stake.length===0)return;const t=(await Q(a.id)).data;t&&typeof t=="object"&&(console.log("approve all tx:",t),await b(await j(t)),await d())},g=async a=>{if(a.nft_to_stake.length===0)return;const t=(await J(a.id,a.nft_to_stake)).data;console.log("stake tx:",t),await b(await j(t)),await d()},w=async a=>{const t=h.find(k=>k.pool_id===a.id);if(!t){console.error("staking not found for pool:",a);return}const i=(await V(a.id,t.token_ids)).data;console.log("unstake tx:",i),await b(await j(i)),await d()},m=async a=>{const t=(await X(a.id)).data;console.log("claim tx:",t),await b(await j(t)),await d()};return e.jsx("div",{className:"card-container",children:n.map((a,t)=>e.jsxs("div",{className:"card-box",children:[e.jsxs("div",{className:"card-title",children:[e.jsx("span",{children:"Staking"}),e.jsx("span",{children:a.type})]}),e.jsx("img",{src:a.img,alt:"card-img-staking"}),e.jsxs("div",{className:"stat-box",children:[e.jsxs("div",{children:[e.jsx("p",{children:"Eligible NFTs to stake"}),e.jsx("span",{children:a.nft_to_stake.length})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Total NFTs Currently Staked"}),e.jsx("span",{children:a.total_staked})]}),e.jsxs("div",{children:[e.jsx("p",{children:"NEOBux Estimated / Per Day"}),e.jsx("span",{children:a.rewards_per_unit_time})]})]}),e.jsxs("div",{className:"unclaimed-box",children:[e.jsx("span",{children:"Unclaimed"}),e.jsxs("p",{children:[a.unclaimed," NEOBux"]})]}),e.jsxs("div",{className:"btn-box-staking",children:[e.jsx(W,{btnText:"claim neobux",onClick:async()=>{await m(a)},disabled:a.unclaimed==="0.0"||a.unclaimed==="0"}),e.jsx(C,{isGlitch:!0,text:"stake",onClick:async()=>{await u(a),await g(a)}}),e.jsx("p",{className:"unstake-btn",onClick:async()=>{await w(a)},children:"Unstake"})]})]},t))})},ae=({authCount:s})=>{const n=$("(max-width: 430px)");return e.jsxs("div",{className:"staking-body-wrapper",children:[e.jsx(ee,{authCount:s}),e.jsx("img",{src:n?P:D,alt:"bottom-line",className:"bottomLine"})]})},te="data:image/svg+xml,%3csvg%20width='19'%20height='14'%20viewBox='0%200%2019%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1%206.38898L6.75661%2012.2539L18%201.25391'%20stroke='%230C0C0C'%20stroke-width='2'/%3e%3c/svg%3e",se=({onChange:s})=>{const[n,o]=l.useState(!1),h=()=>{o(!n),s&&s(!n)};return e.jsx("div",{className:`checkbox ${n?"selected":""}`,onClick:h,style:{userSelect:"none"},children:n&&e.jsx("img",{alt:"",src:te})})},me=()=>{const[s,n]=l.useState(localStorage.getItem("agreed")!=="true"),[o,h]=l.useState(!1),[x,d]=l.useState(0),u=()=>{n(!1),localStorage.setItem("agreed","true")},g=()=>{d(x+1)},w=window.innerWidth<=430,m=e.jsxs("div",{className:"modal-content-box",children:[e.jsx("h2",{children:"STAKING & REWARDS INSTRUCTIONS"}),e.jsxs("div",{className:"list",children:[e.jsxs("ul",{children:[e.jsx("li",{children:"With NEO Staking you can Stake and Unstake at any time"}),e.jsx("li",{children:"While your NFTs are staked, they will be moved to a staking contract, upon unstaking they will return to your wallet"}),e.jsx("li",{children:"NEOBux only accumulate during the time your NFT(s) are staked"}),e.jsx("li",{children:"When Purchasing Reward NFTs: Holders are only eligible to redeem 1 Reward NFT per each founder pass/ genesis NFT you hold at the time of the snapshot for the Reward Period"}),e.jsx("li",{children:"Your NEOBux will remain claimable even if you unstake as long as you hold the NFT"}),e.jsx("li",{children:"All Reward NFT purchases will be verified by the NEO Masterpiece Films team"}),e.jsx("li",{children:"If you are not eligible; we will notify you and return your NEOBux"}),e.jsx("li",{children:"Successful verifications will have their Reward NFTs airdropped with 72 hours"})]}),e.jsx("p",{children:" For all questions: please submit a ticket in the NEO discord server"})]}),e.jsxs("div",{className:"agreement",children:[e.jsxs("div",{className:"agreement-text",children:[e.jsx(se,{onChange:h}),e.jsx("span",{style:w?{fontSize:"10px"}:{},children:"I have read and understand the above"})]}),e.jsx(C,{isGlitch:!0,text:"i agree",disabled:!o,onClick:()=>u()})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(U,{onLogin:g}),e.jsx(ae,{authCount:x}),e.jsx(R,{}),s&&e.jsx(H,{isOpen:s,onClose:u,content:m})]})};export{me as default};
